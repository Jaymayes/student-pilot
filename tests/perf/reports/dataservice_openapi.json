{
  "openapi": "3.0.3",
  "info": {
    "title": "Scholar DataService API",
    "version": "2.0.0",
    "description": "Centralized data access layer for Scholar AI Advisor ecosystem"
  },
  "servers": [
    {"url": "https://student-pilot-jamarrlmayes.replit.app/api/v2/dataservice"}
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Health check",
        "responses": {"200": {"description": "Service healthy"}}
      }
    },
    "/readyz": {
      "get": {
        "summary": "Readiness check (DB ping)",
        "responses": {"200": {"description": "Database connected"}}
      }
    },
    "/users": {
      "get": {
        "summary": "List users (auth required)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"200": {"description": "User list"}, "401": {"description": "Unauthorized"}}
      },
      "post": {
        "summary": "Create user (auth required)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"201": {"description": "User created"}}
      }
    },
    "/users/{id}": {
      "get": {
        "summary": "Get user by ID (FERPA protected)",
        "parameters": [{"name": "id", "in": "path", "required": true, "schema": {"type": "string"}}],
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"200": {"description": "User details"}}
      },
      "put": {
        "summary": "Update user",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"200": {"description": "User updated"}}
      },
      "delete": {
        "summary": "Delete user (soft)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"200": {"description": "User deleted"}}
      }
    },
    "/providers": {
      "get": {"summary": "List providers", "responses": {"200": {"description": "Provider list"}}},
      "post": {
        "summary": "Create provider (auth required)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"201": {"description": "Provider created"}}
      }
    },
    "/scholarships": {
      "get": {"summary": "List scholarships", "responses": {"200": {"description": "Scholarship list"}}},
      "post": {
        "summary": "Create scholarship (auth required)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"201": {"description": "Scholarship created"}}
      }
    },
    "/uploads": {
      "post": {
        "summary": "Create upload metadata (returns upload_id)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"201": {"description": "Upload created with ID"}}
      }
    },
    "/ledgers": {
      "post": {
        "summary": "Create ledger entry (zero-sum validation)",
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"201": {"description": "Ledger entry created"}}
      }
    },
    "/ledgers/reconcile": {
      "get": {
        "summary": "Reconcile ledger by trace_id",
        "parameters": [{"name": "trace_id", "in": "query", "required": true, "schema": {"type": "string"}}],
        "security": [{"bearerAuth": []}, {"apiKey": []}],
        "responses": {"200": {"description": "Reconciliation result"}}
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {"type": "http", "scheme": "bearer", "bearerFormat": "JWT"},
      "apiKey": {"type": "apiKey", "in": "header", "name": "X-API-Key"}
    }
  }
}
