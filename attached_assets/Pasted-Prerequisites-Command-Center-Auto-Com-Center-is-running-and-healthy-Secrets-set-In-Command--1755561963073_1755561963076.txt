Prerequisites

Command Center (Auto Com Center) is running and healthy.
Secrets set:
In Command Center: SHARED_SECRET (same across all apps), AGENTS_ALLOWLIST includes https://student-pilot-jamarrlmayes.replit.app, JWT_ISSUER=auto-com-center, JWT_AUDIENCE=scholar-sync-agents
In Student Pilot app: COMMAND_CENTER_URL=https://auto-com-center-jamarrlmayes.replit.app, SHARED_SECRET (same), AGENT_NAME=student_pilot, AGENT_ID=student-pilot, AGENT_BASE_URL=https://student-pilot-jamarrlmayes.replit.app
Expected Student Pilot Agent capabilities: student_pilot.match_scholarships, student_pilot.analyze_essay
Quick env helpers

export CC=https://auto-com-center-jamarrlmayes.replit.app
export AGENT=https://student-pilot-jamarrlmayes.replit.app
Test 1: Agent capabilities endpoint

Goal: Verify Student Pilot Agent Bridge is live and advertising its actions.
Command: curl -s $AGENT/agent/capabilities
Expect: 200 JSON like: { "agent_id": "student-pilot", "name": "student_pilot", "capabilities": ["student_pilot.match_scholarships", "student_pilot.analyze_essay"], "version": "...", "health": { "ok": true } }
Test 2: Agent visible in Command Center registry

Goal: Confirm auto-registration and heartbeats.
Command: curl -s $CC/orchestrator/agents
Expect: Entry for student-pilot with status online and the two capabilities listed.
Test 3: Health check (agent)

Goal: Verify enhanced health with agent identification.
Command: curl -s $AGENT/health
Expect: { "status": "ok", "agent_id": "student-pilot", ... }
Test 4: Secure task dispatch – match scholarships (happy path)

Goal: Dispatch a real matching task and receive a successful result via callback.
Dispatch: curl -s -X POST $CC/orchestrator/tasks/dispatch -H "Content-Type: application/json" -d '{ "action": "student_pilot.match_scholarships", "payload": { "student": { "gpa": 3.7, "major": "Computer Science", "level": "undergrad", "country": "US" }, "limit": 10 }, "requested_by": "qa", "resources": { "timeout_ms": 20000, "retry": 1 } }'
Expect: 200/202 with { "task_id": "...", "trace_id": "...", "status": "dispatched" }
Poll status: curl -s $CC/orchestrator/tasks/<task_id>
Expect final: status "succeeded" with result { matches: [{ scholarshipId, score, ... }], total or count, took_ms }
Test 5: Secure task dispatch – analyze essay (happy path)

Goal: Verify AI analysis path and callback.
Dispatch: curl -s -X POST $CC/orchestrator/tasks/dispatch -H "Content-Type: "application/json" -d '{ "action": "student_pilot.analyze_essay", "payload": { "prompt": "Why is STEM important to you?", "essay": "From an early age I was fascinated by...", "options": { "tone": "supportive", "maxSuggestions": 5 } }, "requested_by": "qa", "resources": { "timeout_ms": 30000, "retry": 1 } }'
Expect: task completes with result { "feedback": { "strengths": [...], "improvements": [...], "score": number }, "tokensUsed" or similar metrics if exposed }
Test 6: Event emission

Goal: Ensure Student Pilot posts events for audit trail.
Command: curl -s "$CC/orchestrator/events"
Expect: Recent event(s) from source student-pilot with types like "scholarships_matched" and/or "essay_analyzed" and trace_id matching the task.
Test 7: Validation error propagation (negative)

Goal: Structured error when required fields are missing.
Dispatch (missing student profile): curl -s -X POST $CC/orchestrator/tasks/dispatch -H "Content-Type: application/json" -d '{ "action": "student_pilot.match_scholarships", "payload": { "limit": 5 }, "requested_by": "qa" }'
Expect: task ends with status "failed" and error: { "error": { "code": "VALIDATION_ERROR", "message": "...missing student...", "details": {...} } }
Test 8: Security (invalid token rejected)

Goal: Agent Bridge rejects forged/invalid tasks.
Command (direct to agent with bogus token): curl -s -X POST $AGENT/agent/task -H "Content-Type: application/json" -H "Authorization: Bearer not-a-valid-token" -d '{"task_id":"t1","action":"student_pilot.match_scholarships","payload":{"student":{"gpa":3.0}}}'
Expect: 401/403 error indicating invalid token/issuer/audience.
Test 9: AI rate limit (optional)

Goal: Confirm /agent/task applies a conservative limit for AI actions (e.g., 5/min).
Approach: Dispatch 6 essay analysis tasks within a minute.
Expect: 429 Too Many Requests from either Command Center dispatch policy or agent /agent/task rate limiter for the 6th+ request.
Test 10: Relay passthrough via Command Center (optional)

Goal: Prove CC relay can securely proxy to Student Pilot native routes.
Command: curl -s -X POST $CC/orchestrator/relay -H "Content-Type: application/json" -d '{"target_agent_id":"student-pilot","method":"GET","path":"/health","body":null}'
Expect: 200 with the agent’s health JSON; verify Authorization was attached by Command Center (in agent logs).
Pass/Fail criteria

Pass when:
Tests 1–5 succeed (capabilities visible, agent listed online, health ok, both actions complete via callback with results).
Test 6 shows corresponding events with matching trace_id.
Test 7 returns a structured validation failure.
Test 8 returns 401/403 for invalid JWT.
Optional tests 9–10 validate rate limiting and relay if enabled.
Troubleshooting

Agent not listed: Ensure AGENTS_ALLOWLIST in Command Center includes the Student Pilot URL and SHARED_SECRET matches both sides.
Dispatch fails “no agent supports action”: Update /agent/capabilities in Student Pilot to include the two actions and allow the agent to re-register (or trigger a manual heartbeat/register).
Timeouts: Increase resources.timeout_ms in dispatch; verify Student Pilot’s internal AI calls aren’t blocked by its own rate limiter.
Issuer/audience mismatch: Command Center should sign iss=auto-com-center, aud=scholar-sync-agents; Student Pilot should verify the same.
If you want, I can generate a Postman collection or a small bash script pre-filled with these endpoints for Student Pilot similar to the one I provided for the ScholarMatch agent.