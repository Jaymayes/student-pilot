ROLE: Senior DevOps/SDET for a microservices ecosystem
OBJECTIVE: For the single application you are currently assigned to, fix production issues and run an end‚Äëto‚Äëend (E2E) regression to ensure there are no bugs or revenue blockers.

PHASE 1 ‚Äî STRICT LOGIC GATE (IDENTIFY ‚Üí LOCK ‚Üí HANDSHAKE)

DETECT exactly one app using:
APP_ID/APP_NAME/APP_BASE_URL env, package.json, repo folder, framework config, or deployed origin.
LOCK scope to that single app. Ignore all other apps.
HANDSHAKE (print exactly before acting): üîç AGENT IDENTITY CONFIRMED CURRENT APP ID: [Insert Detected ID] TARGET URL: [Insert Detected URL] ACTION: Locking context. Executing remediation + E2E for [Insert ID] only.
If you cannot determine with confidence: ‚ùå ABORT: Unable to determine single App ID with confidence. No actions executed.
APPLICATION REGISTRY (for identification only)

A1 scholar_auth ‚Üí https://scholar-auth-jamarrlmayes.replit.app
A2 scholarship_api ‚Üí https://scholarship-api-jamarrlmayes.replit.app
A3 scholarship_agent ‚Üí https://scholarship-agent-jamarrlmayes.replit.app
A4 scholarship_sage ‚Üí https://scholarship-sage-jamarrlmayes.replit.app
A5 student_pilot ‚Üí https://student-pilot-jamarrlmayes.replit.app
A6 provider_register ‚Üí https://provider-register-jamarrlmayes.replit.app
A7 auto_page_maker ‚Üí https://auto-page-maker-jamarrlmayes.replit.app
A8 auto_com_center ‚Üí https://auto-com-center-jamarrlmayes.replit.app
GLOBAL GUARDRAILS

Non‚Äëdestructive first; writes only if isolated and cleaned up.
Redact secrets/tokens/cookies/emails/Tax IDs as ****.
Max 1 RPS; back off on 429/503.
Production: If no test account, SKIP destructive steps and note reason.
Modify only your app. If another app must change, open a ticket (templates in Phase 7) and STOP.
PHASE 2 ‚Äî REPORT HEADER (prepend every output) E2E TEST REPORT
APP ID: [Insert Your App ID] APP_BASE_URL: [Insert Your Base URL] TIMESTAMP: [ISO8601]
PHASE 3 ‚Äî REMEDIATION SUITES (Execute ONLY your app‚Äôs section)

A1 ‚Äî scholar_auth (Revenue Gatekeeper: callback/server_error, CORS/cookies, RS256)

Fix objectives: Callback stability, CORS for scholaraiadvisor.com and www, RS256 only, no 500 on SQLi probe.
OIDC sanity: GET /oidc/.well-known/openid-configuration ‚Üí issuer, authorization_endpoint, token_endpoint present.
redirect_uris parity: Confirm A5 callback https://student-pilot-jamarrlmayes.replit.app/api/callback is registered.
Callback diagnostics: Ensure logging hasCode/hasState + error codes; enable if missing.
Cookies/CORS: Cookies must be Secure, HttpOnly, SameSite=None; trust proxy set; CORS allow origins scholaraiadvisor.com and www; credentials allowed; OPTIONS ‚Üí 204 verified.
SQLi regression test: POST /api/auth/login {"email":"e2e@test.com","password":"' OR '1'='1"} ‚Üí expect 401/400. If 500, add missing columns (users.password_hash, users.ferpa_protected, users.ferpa_institution_id), rerun.
JWT: JWKS RS256 only; no HS256 fallback.
If invalid_redirect_uri or missing_parameters persists, open A1 ticket and STOP (Phase 7).
A5 ‚Äî student_pilot (Revenue Funnel: PKCE/cookies, Stripe, assets)

Fix objectives: PKCE/state server‚Äëside, Secure/HttpOnly/SameSite=None, trust proxy, Stripe key present, assets 200.
PKCE/state stored server‚Äëside; no sessionStorage dependence.
Cookies: Secure/HttpOnly/SameSite=None; trust proxy on; callback route /api/callback active.
Stripe key present (pk_live_ or pk_test_); checkout unauth ‚Üí 401.
Critical assets main.js/index.css ‚Üí 200.
A2 ‚Äî scholarship_api (Performance & WAF: search < 400ms avg; trust A1 JWT where needed)

Fix objectives: Search latency target < 400ms; CORS exact origins; address potential WAF blocking of A1 JWT on ingest.
GET /health ‚Üí 200, DB=UP.
GET /search?q=engineering ‚Üí 3x runs; if avg > 400ms, add/verify indexes (title/description) or full‚Äëtext/caching; rerun.
If WAF/403 on ingest endpoints (e.g., telemetry): allow A1 JWT via JWKS and disable CSRF for ingestion routes; rerun.
A6 ‚Äî provider_register (Prod 500/stale publish)

Fix objectives: Prod build healthy; /healthz 200; login 302 to A1; upload CORS OK; Stripe connect sanity.
GET /healthz ‚Üí if 404/500, run local build (npm run build) and output: ‚Äú‚ö†Ô∏è ACTION REQUIRED: Republish in Replit UI.‚Äù After republish, GET / ‚Üí 200.
OPTIONS /api/upload ‚Üí 200/204 with correct ACAO/ACAC headers.
/api/login ‚Üí 302 to A1; protected endpoints unauth ‚Üí 401.
Stripe connect status (if exposed): mode=live, key_valid, webhook ok.
A3 ‚Äî scholarship_agent (OIDC discovery + telemetry headers)

Fix objectives: ISSUER_URL exact, telemetry Authorization + X-App-ID present, malformed job handled gracefully.
If OIDC discovery fails: set ISSUER_URL=https://scholar-auth-jamarrlmayes.replit.app/oidc; restart; /api/login ‚Üí 302/200.
Malformed job ‚Üí 4xx, worker stays healthy.
Telemetry 403: Add Authorization: Bearer **** and X-App-ID: scholarship_agent; rerun.
A4 ‚Äî scholarship_sage (Double-response fix + mobile UX)

Fix objectives: No ‚ÄúCannot set headers after they are sent‚Äù; mobile 375px stable.
If any endpoint crashes with double‚Äësend, guard middlewares: check res.headersSent and a responseSent flag before sending.
UI load 200; ‚ÄúList 3 scholarships‚Äù returns list or clarifying prompt; 375px viewport shows Send button (no overlap).
A7 ‚Äî auto_page_maker (SEO/telemetry sanity)

Fix objectives: /sitemap.xml and /robots.txt 200; public pages have non‚Äëempty <title>; telemetry accepted.
GET /sitemap.xml, /robots.txt ‚Üí 200; sample SEO page 200/<title>; POST /api/telemetry/page-view ‚Üí accepted.
A8 ‚Äî auto_com_center (Comms: SSE/WS + webhook ingest)

Fix objectives: /healthz 200; SSE/WS connects, stable ‚â•2s; webhook ingest 200/persists.
GET /healthz ‚Üí 200; connect to /api/telemetry/stream (or /socket.io) and verify first event; POST webhook ‚Üí 200.
PHASE 4 ‚Äî E2E EXECUTION (Run ONLY your app‚Äôs suite)

A1: Frontend sanity ‚Üí Discovery/JWKS ‚Üí Registration (non‚Äëdestructive) ‚Üí Login valid/invalid ‚Üí SQLi ‚Üí Cookie/CORS checks.
A2: Health ‚Üí Authorization boundary ‚Üí Reads ‚Üí Search latency (3x) ‚Üí CORS.
A3: Health ‚Üí Trigger job ‚Üí Poll states ‚Üí Malformed job (graceful) ‚Üí Post‚Äëerror health.
A4: UI load ‚Üí ‚ÄúFind me scholarships for engineering‚Äù ‚Üí Context shift to ‚Äúnursing‚Äù ‚Üí 375px mobile.
A5: Unauth dashboard redirect ‚Üí Stripe key presence ‚Üí main.js/index.css 200 ‚Üí Checkout 401 unauth.
A6: Homepage 200 ‚Üí OPTIONS /api/upload ‚Üí Stripe connect status (if exposed) ‚Üí /api/login 302 to IdP.
A7: Health ‚Üí sitemap/robots ‚Üí SEO page title ‚Üí Telemetry accept.
A8: /healthz ‚Üí SSE/WS handshake ‚Üí Webhook ingest 200 ‚Üí Exec overview 200.
PHASE 5 ‚Äî EVIDENCE & ASSERTIONS (EVERY STEP)

Log: Method, URL, Status, Duration(ms)
Headers: Capture only Set‚ÄëCookie flags (Secure/HttpOnly/SameSite) and CORS (no values)
Assertion: Expected vs observed (one line)
Redact: **** for all secrets/tokens/cookies
PHASE 6 ‚Äî FINAL SUMMARIES (REQUIRED)

Test summary table
Columns: Test Case | Status (PASS/FAIL/SKIP) | Notes/Evidence (redacted)
2. Revenue‚Äëblocker table

Auth/Security (SQLi) | DB Connectivity | Stripe/Revenue Key | Critical Assets (JS/CSS) | OIDC/JWKS Integrity | CORS for Frontends
VERDICT: [READY FOR TRAFFIC / BLOCKED]
PHASE 7 ‚Äî CROSS‚ÄëAPP TICKETS (copy/paste; fill fields; STOP after filing)

A1 Client Registration Update ‚Äî [Your App]
App: [Your App] | Base: [Your URL]
redirect_uris: ["[Your URL]/api/callback"]
post_logout_redirect_uris: ["[Your URL]"]
scopes: ["openid","email","profile","offline_access"]
token_endpoint_auth_method: [client_secret_basic|none (PKCE)]
Evidence: invalid_redirect_uri / missing_parameters / server_error (redacted)

A1 CORS & Cookie Alignment ‚Äî scholaraiadvisor.com
Need: Allow scholaraiadvisor.com + www; SameSite=None; trust proxy; callback diagnostics active
Evidence: callback?error=missing_parameters or server_error (redacted)

A2 Search Latency Optimization
Observation: /search latency [value]ms (>400ms)
Request: Add indexes [fields]/enable full‚Äëtext or caching; confirm and re‚Äëtest

A6 Republish Required ‚Äî provider_register
Observation: /healthz 404/500 on production URL
Action: Build OK locally; requires manual republish in Replit UI

PHASE 8 ‚Äî COMPLETION CHECK

Identity Handshake printed
ONLY your app‚Äôs remediation + E2E executed
Report header + final revenue‚Äëblocker table + definitive VERDICT
Zero‚ÄëAd‚ÄëSpend Directive (Ready to send to Marketing)

Effective immediately: Pause all paid campaigns (Google/Meta/TikTok/Snap/Reddit) until auth stability is confirmed.
Re‚Äëactivation criteria (24‚Äëhour window, production telemetry):
Login success rate (P95) ‚â• 99.2%
Auth callback errors (missing_parameters/server_error) ‚â§ 0.5% of login attempts
A1 endpoint health (p95 latency) ‚â§ 250 ms; uptime ‚â• 99.9%
A5 checkout initiation rate not degraded vs trailing 7‚Äëday organic baseline
Traffic handling during hold:
Route organic traffic normally.
If callback error rate > 1% any hour, auto‚Äëswitch top‚Äëof‚Äëfunnel CTAs to ‚ÄúJoin Waitlist‚Äù and show incident banner.
Reporting cadence:
Engineering: Hourly report of Attempted Logins vs Successful Tokens; top 3 failure reasons (redacted).
Growth: Daily spend/resume recommendation with funnel metrics.
Owner and due:
Marketing Lead: Pause now; confirm in Slack within 15 minutes.
Engineering Lead: First stability report due T+4h; then hourly until ad re‚Äëenable decision.
If you want this individualized per app (e.g., only A1 and A5 agents equipped with repair authority, others ticket‚Äëonly), I can produce the minimal variants next.