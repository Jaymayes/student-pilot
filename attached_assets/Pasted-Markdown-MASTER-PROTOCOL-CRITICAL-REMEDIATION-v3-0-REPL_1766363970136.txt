Markdown# üîß MASTER PROTOCOL: CRITICAL REMEDIATION (v3.0 - REPL_ID FIX)

**ROLE:** Senior DevOps Engineer & Security Architect
**OBJECTIVE:** Resolve the specific production blockers (Auth "Server Error" & Stale Deployments) and verify the ecosystem is Production Ready.

## üõë PHASE 1: MANDATORY INITIALIZATION (LOGIC GATE)

**CRITICAL INSTRUCTION:**
You have instructions for 8 applications. **You must NOT execute them all.**

1.  **DETECT:** Analyze your environment (`APP_BASE_URL`, `package.json`, directory) to identify your **ONE** App ID.
2.  **LOCK:** Select your specific **Suite** below. **IGNORE** all others.
3.  **HANDSHAKE:** Output this log before acting:

> **üîß REMEDIATION AGENT ONLINE**
> **CURRENT APP ID:** [Insert Detected ID]
> **TARGET URL:** [Insert Detected URL]
> **ACTION:** Applying P0 Fixes (REPL_ID/Stripe/Build) and verifying production status.

---

## üìÇ APPLICATION REGISTRY & KNOWN ISSUES

| APP ID | BASE URL | KNOWN ISSUE (FIX THIS) |
| :--- | :--- | :--- |
| **scholar_auth** | `https://scholar-auth-jamarrlmayes.replit.app` | **CRITICAL:** Login "Server Error" (REPL_ID Mismatch) & Stripe Conflict. |
| **scholarship_api** | `https://scholarship-api-jamarrlmayes.replit.app` | **WARN:** High Search Latency (>900ms). |
| **provider_register** | `https://provider-register-jamarrlmayes.replit.app` | **CRITICAL:** Prod returns 500 (Stale Build). |
| **student_pilot** | `https://student-pilot-jamarrlmayes.replit.app` | **PASS:** Revenue Config Check. |
| *(All Others)* | `...` | **PASS:** Run Sanity Check. |

---

## üìù PHASE 2: REPORTING HEADER

**RULE:** Start every output with:

```text
REMEDIATION REPORT
==================
APP ID: [Insert ID]
TIMESTAMP: [ISO8601]
--------------------------------------------------
‚öôÔ∏è PHASE 3: FIX & VERIFY SUITES (EXECUTE ONLY ONE)Find your APP ID below. Execute ONLY that section.üî¥ SUITE 1: scholar_auth (The Revenue Gatekeeper)Step 1: Fix OIDC "Server Error" (P0 - CRITICAL)Diagnosis: The REPL_ID secret is manually overriding the platform-provided ID, causing a mismatch with the Replit OIDC provider during production login.Action: Check your Environment/Secrets.FIX: DELETE the REPL_ID secret. (Allow Replit to auto-inject the correct Production ID).Secondary Fix: Ensure redirect_uri in server/auth.ts (or similar) explicitly matches https://scholar-auth-jamarrlmayes.replit.app/api/auth/callback.Step 2: Remove Publishing BlockerAction: If Stripe Integration is active in the Replit UI (left sidebar), Disconnect/Delete it.Code Action: If stripe exists in package.json, remove it.Goal: Allow "Publish" to succeed.Step 3: VerificationAction: GET /oidc/.well-known/openid-configuration. ASSERT: Status 200.Manual Trigger: Output "‚ö†Ô∏è MANUAL ACTION: Click 'Publish' to apply the REPL_ID removal."üü£ SUITE 6: provider_register (Deployment Repair)Step 1: Production DiagnosisAction: GET https://provider-register-jamarrlmayes.replit.app/healthz (External URL).Condition: If Status is 500 or 404, the production build is stale/crashed.Fix Action: Run npm run build locally to verify build integrity.Output: "‚ö†Ô∏è ACTION REQUIRED: Manual Republish needed in Replit UI to sync fixes."Step 2: VerificationAction: GET /. ASSERT: Status 200 (No "Application Error" screen).üü† SUITE 2: scholarship_api (Performance)Step 1: Latency FixAction: Check Database Indexes.Fix: Add CREATE INDEX IF NOT EXISTS idx_scholarships_title ON scholarships(title); and CREATE INDEX IF NOT EXISTS idx_scholarships_description ON scholarships(description);.Step 2: VerificationAction: GET /search?q=engineering. ASSERT: Time < 900ms.üîµ SUITE 5: student_pilot (Revenue Check)Step 1: Revenue ConfigAction: Scan for VITE_STRIPE_PUBLIC_KEY.ASSERT: Key exists and starts with pk_live_ or pk_test_.Step 2: VerificationAction: GET /api/checkout (Unauth). ASSERT: Status 401.‚ö™ OTHER APPS (scholarship_agent, scholarship_sage, auto_page_maker, auto_com_center)Step 1: Golden Path VerificationAction: GET /health (or /healthz). ASSERT: Status 200.Action: GET /. ASSERT: Status 200.üèÅ PHASE 4: FINAL SIGN-OFFINSTRUCTION: Output the final status table.App IDStatusFix Applied?[Your ID]PASS / FAIL[Yes (Details) / No]End of Protocol.