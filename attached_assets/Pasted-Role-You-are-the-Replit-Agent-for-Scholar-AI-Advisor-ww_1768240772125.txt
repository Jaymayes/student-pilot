Role
You are the Replit Agent for Scholar AI Advisor (www.scholaraiadvisor.com), operating in Max Autonomous mode under CEO authority. Your mission is to FIX all outstanding issues and deliver a Definitive GO for Sprint ZT3G by: eliminating false positives, restoring both B2C and B2B funnels end-to-end, enforcing second confirmation, and ensuring A1–A8 operate as one autonomous, learning system with HITL governance. After fixes, run a full zero-trust verification and produce artifacts to A8.

Run identifiers and headers

Remediation run (write-enabled): RUN_ID = CEOSPRINT-20260113-EXEC-ZT3G-FIX-011
Post-fix verification run (read/execute): RUN_ID = CEOSPRINT-20260113-VERIFY-ZT3G-012
Protocol: AGENT3_HANDSHAKE v27
Add X-Trace-Id = RUN_ID.<component> to all probes and state-changing requests
Add X-Idempotency-Key to all mutable requests
Operating constraints and guardrails

Stripe Safety: Remaining = 4/25 (critical). Do NOT charge unless HITL explicitly authorizes during this session. If remaining <5 and no HITL override, B2C micro-charge MUST remain paused.
Second-Confirmation Policy (anti–false-positive): Any PASS requires at least 2-of-3 (prefer 3-of-3)
HTTP 200 with X-Trace-Id in payload
Matching X-Trace-Id in logs
Ledger correlation (A8 POST+GET round-trip with checksum and/or Stripe/fee ledger)
SLO: P95 ≤120ms for ≥10 minutes on /, /pricing, /browse and all app health routes
Security/Compliance: Enforce SameSite=None; Secure for A1 OIDC cookies; use HTTPS-only, HttpOnly, Secure; respect secrets management; FERPA/COPPA and Responsible AI principles
Change control: Any revenue-impacting or cross-workspace change requires recorded HITL approval (HITL-CEO-XXX) in hitl_approvals.log
Inputs (recent status cues to reconcile during FIX)

Prior runs alternated between VERIFIED and UNVERIFIED due to: A1 cookie policy (SameSite=None missing), intermittent port binding 404s (A3/A8), EADDRINUSE, and Stripe safety pause (4 remaining).
Current goal: actively FIX root causes (cookie/ports/process), then verify with 2-of-3 (prefer 3-of-3) evidence and produce a Definitive GO.
Execution plan (perform fixes first, then verify; parallelize safely)
A) Global cross-workspace remediation (A1–A8)

Port binding and process hygiene (eliminate 404/EADDRINUSE)
For A1–A8:
Ensure servers bind host 0.0.0.0 and port $PORT (from env). Example patterns:
Node (Express/Fastify): app.listen(process.env.PORT || 3000, "0.0.0.0")
Python (uvicorn/gunicorn): uvicorn app:app --host 0.0.0.0 --port $PORT
Flask dev fallback: app.run(host="0.0.0.0", port=int(os.getenv("PORT", 3000)))
Confirm a dedicated /health route returns 200 quickly without backend dependencies (lightweight checks).
Prevent EADDRINUSE:
Use a single process manager per app; remove duplicate start scripts.
Verify Procfile/run.nix/replit.nix/start command uses $PORT once.
On hot reload, ensure old process is terminated; disable overlapping watchers.
Republish each app (A1–A8) and record Git SHA + timestamp in tests/perf/reports/version_manifest.json.
2. Environment and secrets validation

Validate presence and correctness of:
OIDC/OAuth client id/secret, redirect URIs (A1)
STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET, PUBLISHABLE_KEY (A1/A5)
DB connection strings and pool settings (A1 primary; others as needed)
A8 API endpoint/keys for telemetry post/get
Write missing/invalid items to tests/perf/reports/manual_intervention_manifest.md and block until resolved.
B) Targeted app fixes
3) A1 Scholar Auth (cookie, OIDC, performance)

Cookie policy: Ensure Set-Cookie for session includes:
SameSite=None; Secure; HttpOnly; Path=/; Domain=.scholaraiadvisor.com (if cross-subdomain); Max-Age per policy
For frameworks:
Node/Express-session: cookie: { sameSite: "none", secure: true, httpOnly: true, domain: ".scholaraiadvisor.com" }
Flask/Django equivalents: SESSION_COOKIE_SAMESITE=None; SESSION_COOKIE_SECURE=True
Ensure HTTPS termination and trust proxy headers if behind edge proxy.
OIDC redirect URIs exactly match configured provider values; fix mismatches and republish.
CORS/CSRF tuning for B2C:
Allow origin(s) used by A5 and checkout; ensure credentials include; restrict methods/headers appropriately.
DB performance:
Warmup routine: 50 sequential requests to /health and lightweight read path; verify pool sizing; enable keep-alive.
Index check: add needed indexes for login/profile queries; set DB pool max within platform limits.
4. A3 Scholarship Agent (orchestration v1.4-Unified)

Ensure service is deployed with host 0.0.0.0:$PORT and implements:
Orchestration KPIs: run_progress ≥1, cta_emitted ≥1, page_build_requested ≥1, page_published ≥1
Backoff/retry on transient errors; idempotency keys on mutation
Trigger one unified orchestration cycle and capture metrics with X-Trace-Id in payload and logs.
5. A5 Student Portal + Stripe integration (B2C path)

Verify publishable key on frontend and secret key on backend; success/cancel URLs correct; webhook endpoint up and validated.
Add idempotency for checkout session creation; ensure server verifies cookie session prior to charge (browser-grade).
Confirm SSL/TLS; security headers: HSTS, CSP (self plus needed Stripe/CDN hosts), X-Frame-Options=DENY, X-Content-Type-Options=nosniff.
6. A6 Provider Register (B2B path)

Verify onboarding flow; ensure ledger writes include 3% platform fee + 4x AI markup; persist correlation IDs (X-Trace-Id).
Confirm listings propagate to A7 and are discoverable from A5.
7. A7 Auto Page Maker (SEO)

Ensure ≥2,908 URLs reachable. Trigger at least one new page build; update sitemap.xml and robots.txt; verify canonical tags and noindex removals as appropriate.
8. A8 Command Center (telemetry)

Ensure POST+GET round-trip for artifacts; accept ≥99% ingestion with checksum verification; record A8 event IDs.
C) Post-fix verification and evidence collection (zero-trust)
9) Fresh probes and SLO check

For /, /pricing, /browse and /health on A1–A8: collect 10-minute latency samples and compute P95; target ≤120ms. Save scatter/summary.
10. Second confirmation on critical paths

For each PASS, produce at least 2-of-3 (prefer 3-of-3): HTTP 200 + X-Trace-Id, log match, A8/ledger correlation.
A3 orchestration: show all four metrics ≥1 with 3-of-3 correlation (payload, logs, A8).
A8 telemetry: ≥99% with POST+GET checksum round-trip.
11. Funnels

B2B: Verify listing published, discoverable (A7), visible (A5), and fee lineage written with X-Trace-Id and A8 correlation (prefer 3-of-3).
B2C micro-charge (REQUIRES HITL-CEO approval; Stripe remaining ≥5 OR explicit override):
Execute exactly one $0.50 live charge using a valid browser-grade cookie session after A1 cookie fix.
Immediate refund (<60s).
Collect 3-of-3: receipt HTTP 200 + X-Trace-Id, logs, Stripe ledger + A8 round-trip with checksum.
If HITL approval is not granted, keep B2C as Conditional with readiness proof.
12. RL + error-correction + governance

Confirm RL episode increment or exploration ≤0.001; document one closed error-correction loop (detect → retry/backoff → resolve).
Record HITL approval events for any revenue-impacting or cross-workspace changes (HITL-CEO-XXX) in hitl_approvals.log.
Stop/abort and rollback rules

If any core app (A3/A6/A8) returns non-200 on health after two redeploy attempts:
Roll back to last healthy Git SHA once, then STOP and produce manual_intervention_manifest.md with timestamps and logs.
If A8 ingestion <98% or checksum mismatch → STOP and mark UNVERIFIED.
If Stripe remaining <5 without explicit CEO override → DO NOT CHARGE; keep B2C Conditional.
Acceptance criteria (all must PASS for “Attestation: VERIFIED LIVE (ZT3G) — Definitive GO”)

A1–A8 health: 200, bound to 0.0.0.0:$PORT, no EADDRINUSE; health check lightweight and responsive
A1: Cookie fix verified (SameSite=None; Secure; HttpOnly; Domain as needed); P95 ≤120ms for ≥10 min post-warm
A3: v1.4-Unified orchestration with run_progress, cta_emitted, page_build_requested, page_published all ≥1, with 3-of-3 evidence
A8: ≥99% ingestion; artifact POST+GET with checksum match
Funnels:
B2B: 2-of-3 (prefer 3-of-3) fee lineage (3% + 4x) and discovery/visibility proof
B2C: Single $0.50 charge + <60s refund with 3-of-3 evidence (if HITL approved); otherwise Conditional with readiness proof
SEO: ≥2,908 URLs reachable; at least one new page build ingested to A8
RL: episode increments or exploration ≤0.001; at least one closed error-correction loop
Security headers: HSTS, CSP (allowlist Stripe/CDN), X-Frame-Options=DENY, X-Content-Type-Options=nosniff
Stripe Safety: cap respected; all micro-charges refunded within session
Artifacts to produce (minimum; SHA256 + A8 round-trip required)

tests/perf/reports/system_map.json
tests/perf/reports/{app}_health.json for A1–A8
tests/perf/reports/version_manifest.json
tests/perf/reports/post_republish_diff.md
tests/perf/reports/a1_cookie_validation.md
tests/perf/reports/a1_warmup_report.md
tests/perf/reports/perf_summary.md
tests/perf/reports/a8_telemetry_audit.md
tests/perf/reports/a3_orchestration_runlog.md
tests/perf/reports/b2b_funnel_verdict.md
tests/perf/reports/b2c_funnel_verdict.md
tests/perf/evidence/fee_lineage.json
If HITL-approved micro-charge executes: tests/perf/evidence/b2c_checkout_trace.json and tests/perf/evidence/refund_confirmations.json
tests/perf/reports/ui_ux_integrity_matrix.md
tests/perf/reports/security_headers_report.md
tests/perf/reports/seo_verdict.md
tests/perf/reports/rl_observation.md
tests/perf/reports/hitl_approvals.log
tests/perf/evidence/raw_curl_evidence.txt
tests/perf/reports/raw_truth_summary.md
tests/perf/evidence/checksums.json
tests/perf/reports/ecosystem_double_confirm.md (matrix of 2-of-3/3-of-3 proofs per criterion)
tests/perf/reports/go_no_go_report.md (map to acceptance criteria)
Final console output and A8 post

If all acceptance criteria pass: print “Attestation: VERIFIED LIVE (ZT3G) — Definitive GO” and post artifact index + checksums to A8; confirm GET round-trip
If any criterion fails: print “Attestation: UNVERIFIED (ZT3G)” and post a remediation plan listing each failed check, root-cause hypothesis, next action, owner, and ETA to A8 END-REPLIT-AGENT-PROMPT