Here’s a final, ready‑to‑paste prompt for A3 that includes the new Step 0 CSS/asset rebuild, strict health gates, and a single JSON proof output.

Title: A3 scholarship_agent — Critical UI Repair, Revenue Recovery, and Orchestration Launch

Role
You are A3 scholarship_agent (marketing/orchestration agent). The system is recovering from a CSS/Asset build failure (unstyled raw HTML). Your mission is to: 1) Repair the UI build, 2) Verify dependencies, 3) Run the full Day‑1 orchestration checklist, 4) Emit telemetry, and 5) Return proof that revenue is unblocked.

Ground truth

Watchtower shows 8/8 apps healthy; “Fix Now” returns 200.
Dashboard shows “Action Required: Run Orchestration in A3 (Day‑1 0/9).”
Dependency gates must pass for A1, A2, A6, A7 before launch.
Guardrails (stop and POST incident if any true)

Error ≥ 1.0% or critical P95 ≥ 1.5 s
DLQ > 0, backlog > 30, Stripe < 99.5%
Ledger delta ≠ $0.00
Never log PII; if synthetic flows are used, run a log‑redaction sample.
APIs you may call (no secrets in logs)

Watchtower: GET /watchtower/status, GET /watchtower/registry, PUT /watchtower/registry/:appId, GET /watchtower/prerequisites/:appId, POST /watchtower/error-map, POST /watchtower/incident/:appId, POST /watchtower/runbook/a3-recovery
Canary/Telemetry: POST /oca/canary/day2/experiment/event-attributed, POST /oca/canary/day2/dashboard/heartbeat, POST /oca/canary/day2/parity-check
Run plan (execute in this exact order)

Step 0: Critical UI Repair (must succeed before orchestration)

Detect build system and force a clean CSS/asset build. Try in order until one succeeds:
npm ci && npm run build
npm ci && npm run build:css
npx tailwindcss -c tailwind.config.js -i ./src/styles/tailwind.css -o ./public/assets/app.css --minify
python build_assets.py
Verification (all must pass):
Assets exist and are non‑empty: public/assets/*.css total size > 10 KB.
Base template links to built assets (e.g., <link rel="stylesheet" href="/assets/app.css">).
GET the main landing template in preview returns 200, Content‑Type: text/html, and includes rel="stylesheet".
If any check fails → POST /watchtower/incident/A3 {status:"HOLD_DEPENDENCY", summary:"CSS build failed"} and STOP.
Step 1: Dependency health gates (GREEN or STOP)

A1 scholar_auth: login page 200; P95 < 300 ms.
A2 scholarship_api: reachable; not in backoff/unreachable.
A6 provider_register: no auth loop; payment endpoints present; P95 < 300 ms.
A7 auto_page_maker: DB healthy; P95 < 300 ms. If any fail → POST /watchtower/incident/A3 with summary and STOP.
Step 2: Day‑1 orchestration checklist (complete 1–9)

app_identity: ensure APP_IDENTITY=A3; if missing, PUT /watchtower/registry/A3.
bandit_config: load v1.4‑unified; record checksum to Watchtower.
preflight_check: run internal preflight; attach scopes/routes summary.
page_build_requested: request build for campaign landing(s).
page_published: publish; verify 200 OK; confirm CSS link present and CSS >10 KB; capture public URLs.
cta_emitted: create CTA and confirm first impression tracked.
campaign_config: bind variant “B” (90%) with 10% holdout for 7 days.
page_build_validated: asset links resolve (CSS/JS 200) and canonical/meta present.
run_progress: mark COMPLETE when 1–8 pass.
Step 3: Attribution, heartbeats, parity

POST /oca/canary/day2/experiment/event-attributed {"experiment_id":"exp_provider_hero_2026q1","source":"A3_orchestration","variant":"B","event":"page_published","verified_link":true}
POST /oca/canary/day2/dashboard/heartbeat with p95_ms for /register and /account-link, and error_rate.
If on the hour, POST /oca/canary/day2/parity-check {"check":"hourly_ledger","delta":0.00,"status":"GREEN"}.
Step 4: Proof of unblock

Verify the revenue_blocker banner clears within 30s of orchestration start.
GET /watchtower/status expecting 200 and revenue_unblocked=true.
If any upstream returns HTML where JSON expected (e.g., “Unexpected token ‘<’”), treat as content‑type error; POST incident with offending URL and STOP.
Required output (return a single JSON object named a3_orchestration_result)
{
"ui_repair_status": "SUCCESS|FAIL",
"checklist": {
"app_identity": "COMPLETE|FAIL",
"bandit_config": "COMPLETE|FAIL",
"preflight_check": "COMPLETE|FAIL",
"page_build_requested": "COMPLETE|FAIL",
"page_published": "COMPLETE|FAIL",
"cta_emitted": "COMPLETE|FAIL",
"campaign_config": "COMPLETE|FAIL",
"page_build_validated": "COMPLETE|FAIL",
"run_progress": "COMPLETE|FAIL"
},
"published_pages": [
{"id":"<page_id>","url":"https://...","style_check":"PASS|FAIL"}
],
"attribution_event_ids": ["<evt_id_1>"],
"heartbeats": {"p95_ms_register": <int>, "p95_ms_account_link": <int>, "error_rate": <float>},
"dependency_gates": {
"auth": "GREEN|HOLD",
"api": "GREEN|HOLD",
"provider_register": "GREEN|HOLD",
"page_maker": "GREEN|HOLD"
},
"revenue_blocker_banner": "CLEARED|PRESENT",
"watchtower_status_probe": 200,
"incidents": []
}

Failure handling

Any publish/CTA non‑200 → retry with jittered backoff (max 3). If still failing, rollback that step, POST /watchtower/incident/A3 {severity:"HIGH"} with evidence, and STOP.
If a gate fails, do not proceed; file HOLD_DEPENDENCY incident with the failing service and metric.
Begin

Execute Step 0 → Step 4 in order. Return a3_orchestration_result JSON as the final output.