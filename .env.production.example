# Production Environment Configuration for ScholarLink
# Copy to .env.production and fill in actual values

# =============================================================================
# CORE APPLICATION SETTINGS
# =============================================================================
NODE_ENV=production
PORT=5000
TRUST_PROXY=true

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Primary PostgreSQL Database (use least-privileged user with TLS)
DATABASE_URL=postgresql://username:password@host:5432/scholarlink?sslmode=require

# Connection pool settings
PGPORT=5432
PGUSER=scholarlink_prod
PGPASSWORD=<secure-password>
PGDATABASE=scholarlink_prod
PGHOST=<production-host>

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# Session configuration
SESSION_SECRET=<openssl-rand-base64-48>

# Replit OIDC Authentication
REPL_ID=<your-repl-id>
REPLIT_DOMAINS=<your-production-domain.replit.app>
ISSUER_URL=https://replit.com/oidc

# JWT Configuration (for agent communications)
JWT_ALGORITHM=RS256
JWT_PRIVATE_KEY=<path-to-jwt-private.pem>
JWT_PUBLIC_KEY=<path-to-jwt-public.pem>
JWT_ISSUER=scholarlink-agent
JWT_AUDIENCE=auto-com-center

# =============================================================================
# AGENT BRIDGE CONFIGURATION 
# =============================================================================
# Auto Com Center Integration
SHARED_SECRET=<hmac-secret-base64-48>
COMMAND_CENTER_URL=https://auto-com-center-production.replit.app
AGENT_NAME=student_pilot
AGENT_ID=student-pilot
AGENT_BASE_URL=https://<your-domain>.replit.app

# =============================================================================
# OBJECT STORAGE CONFIGURATION
# =============================================================================
# Google Cloud Storage via Replit Sidecar
DEFAULT_OBJECT_STORAGE_BUCKET_ID=<your-bucket-id>
PUBLIC_OBJECT_SEARCH_PATHS=/<bucket-name>/public,/<bucket-name>/assets
PRIVATE_OBJECT_DIR=/<bucket-name>/.private

# =============================================================================
# AI SERVICES
# =============================================================================
# OpenAI API for essay assistance and scholarship matching
OPENAI_API_KEY=<your-openai-api-key>

# =============================================================================
# CORS & SECURITY HEADERS
# =============================================================================
CORS_ALLOWED_ORIGINS=https://<your-domain>.replit.app,https://<custom-domain>
CSP_REPORT_URI=https://<your-domain>.replit.app/csp-report
HSTS_MAX_AGE=31536000

# =============================================================================
# RATE LIMITING & MONITORING
# =============================================================================
# Redis for distributed rate limiting (optional)
REDIS_URL=rediss://username:password@host:6380

# Rate limiting configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AGENT_MAX=5

# =============================================================================
# OBSERVABILITY & LOGGING
# =============================================================================
# Error tracking
SENTRY_DSN=<your-sentry-dsn>

# Logging configuration
LOG_LEVEL=info
LOG_FORMAT=json
CORRELATION_ID_HEADER=x-correlation-id

# Metrics (if using external monitoring)
METRICS_ENABLED=true
METRICS_AUTH_TOKEN=<metrics-endpoint-auth>

# =============================================================================
# ENCRYPTION & DATA PROTECTION
# =============================================================================
# For encrypting sensitive fields at rest
ENCRYPTION_KEY=<aes-256-key-base64>

# File upload limits
MAX_FILE_SIZE=10485760
MAX_FILES_PER_UPLOAD=5

# =============================================================================
# EXTERNAL INTEGRATIONS (Optional)
# =============================================================================
# Email notifications
SMTP_HOST=<smtp-server>
SMTP_PORT=587
SMTP_USER=<smtp-username>
SMTP_PASS=<smtp-password>
SMTP_FROM=noreply@<your-domain>

# Webhook endpoints
WEBHOOK_SECRET=<webhook-validation-secret>

# =============================================================================
# PRODUCTION DEPLOYMENT NOTES
# =============================================================================
# 1. Generate JWT keys:
#    openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:4096 -out jwt_private.pem
#    openssl rsa -in jwt_private.pem -pubout -out jwt_public.pem
#
# 2. Generate secure secrets:
#    openssl rand -base64 48
#
# 3. Database setup:
#    npm run db:push
#
# 4. Health check endpoint:
#    GET /health
#
# 5. Agent registration:
#    POST /agent/register (with Bearer token)